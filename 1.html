<html>
<head>
<style type="text/css">
*{margin:0; padding:0}

</style>
</head>
<body>

<div id="container">

</div>

<script id="2d-vertex-shader" type="x-shader/x-vertex">
attribute vec2 a_position;

void main(){
  gl_Position = vec4(a_position, 0, 1);
}
</script>

<script id="2d-fragment-shader" type="x-shader/x-fragment">
precision mediump float;

uniform vec2 u_center;

void main(){
  float v_comp1 = sin( (distance( gl_FragCoord.xy, u_center ) ) / 90.0 );
  float v_comp2 = sin( gl_FragCoord.x / 90.0 );
  float v_comp3 = (v_comp1 + v_comp2) / 2.0 ;
  gl_FragColor = vec4(
      sin( (v_comp3 * 3.14) ) * 0.8,
      0.5 + cos( (v_comp3 * 3.14) ) / 4.0 ,
      0.5,
      1
  );
}
</script>
<script type="text/javascript">
  function createShaderFromScriptElement(doc, glCtx, scriptId){
    var shaderElt   = doc.getElementById(scriptId),
        shaderSrc   = shaderElt.text,
        shaderType  = (function(ctx, t){
          if(t === "x-shader/x-vertex")
            return ctx.VERTEX_SHADER;
          else if(t === "x-shader/x-fragment")
            return ctx.FRAGMENT_SHADER;
          else 
            throw new Error("Can't guess the type of the shader with id "+scriptId);
        })(glCtx, shaderElt.type),
        shader      = glCtx.createShader(shaderType);

    glCtx.shaderSource(shader, shaderSrc);
    glCtx.compileShader(shader);

    if(!glCtx.getShaderParameter(shader, glCtx.COMPILE_STATUS)){
        console.log("shader " + shader + " failed with error : " + glCtx.getShaderInfoLog(shader));
        throw new Error("fuckit!");
    }

    return shader;
  };

  (function(container){
    var canvas  = document.createElement("canvas"),
        ctx     = canvas.getContext("experimental-webgl"),
        vShader = createShaderFromScriptElement(document, ctx, "2d-vertex-shader"),
        fShader = createShaderFromScriptElement(document, ctx, "2d-fragment-shader"),
        program = ctx.createProgram();

    canvas.height = window.innerHeight;
    canvas.width  = window.innerWidth;

    ctx.viewport(0, 0, window.innerWidth, window.innerHeight);

    ctx.attachShader(program, vShader);
    ctx.attachShader(program, fShader);

    ctx.linkProgram(program);

    ctx.useProgram(program);

    var posLoc    = ctx.getAttribLocation(program, "a_position"),
        buffer    = ctx.createBuffer(),
        centerLoc = ctx.getUniformLocation(program, "u_center");

    ctx.bindBuffer(ctx.ARRAY_BUFFER, buffer);
    ctx.bufferData(
      ctx.ARRAY_BUFFER,
      new Float32Array([
        -1.0, -1.0,
         1.0, -1.0,
        -1.0,  1.0,
        -1.0,  1.0,
         1.0, -1.0,
         1.0,  1.0
      ]),
      ctx.STATIC_DRAW
    );

    ctx.enableVertexAttribArray(posLoc);
    ctx.vertexAttribPointer(posLoc, 2, ctx.FLOAT, false, 0, 0);

    setInterval(function(){
        var x       =  Math.sin( (new Date()).getTime() / 2000 ) * 500 + 500,
            y       =  Math.sin( (new Date()).getTime() / 4000 ) * 200 + 300,
            center  = ctx.uniform2f( centerLoc, x, y);
        ctx.drawArrays(ctx.TRIANGLES, 0, 6);
    }, 1000/30);

    container.appendChild(canvas);
  })(document.getElementById("container"));
</script>

</body>

</html>
